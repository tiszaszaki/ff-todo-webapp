<div class="container" role="main">
	<div>
		<app-ff-todo-generic-board-form #editBoardForm [mode]="EDIT_BOARD" [(model)]="boardContent"
				[descriptionMaxLength]="boardDescriptionMaxLength"
				[preparingFormEvent]="prepareEditBoardFormTrigger.asObservable()" (submitDataEvent)="editBoard($event)">
		</app-ff-todo-generic-board-form>

		<app-ff-todo-generic-board-form #removeBoardForm [mode]="REMOVE_BOARD" [(model)]="boardContent"
				[preparingFormEvent]="prepareRemoveBoardFormTrigger.asObservable()" (submitDataEvent)="removeBoard($event)">
		</app-ff-todo-generic-board-form>

		<app-ff-todo-generic-todo-form #editTodoForm [mode]="EDIT_TODO" [(model)]="todoSelected" [phase_labels]="phase_labels"
				[descriptionMaxLength]="todoDescriptionMaxLength" [inputDateFormat]="inputDateFormat"
				[preparingFormEvent]="prepareEditTodoFormTrigger.asObservable()" (submitDataEvent)="updateTodo($event)">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form #cloneTodoForm [mode]="CLONE_TODO" [(model)]="todoSelected" [phase_labels]="phase_labels"
				[preparingFormEvent]="prepareCloneTodoFormTrigger.asObservable()" (submitDataEvent)="cloneTodo($event)">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form #removeTodoForm [mode]="REMOVE_TODO" [(model)]="todoSelected"
				[preparingFormEvent]="prepareRemoveTodoFormTrigger.asObservable()" (submitDataEvent)="removeTodo($event)">
		</app-ff-todo-generic-todo-form>
	</div>
	<div>
		<app-ff-todo-generic-task-form #addTaskForm [mode]="ADD_TASK" [todoId]="todoId"
				[preparingFormEvent]="prepareAddTaskFormTrigger.asObservable()" (submitDataEvent)="addTask($event)">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #editTaskForm [mode]="EDIT_TASK" [todoId]="todoId" [(model)]="taskSelected"
				[preparingFormEvent]="prepareEditTaskFormTrigger.asObservable()" (submitDataEvent)="updateTask($event)">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #removeTaskForm [mode]="REMOVE_TASK" [todoId]="todoId" [(model)]="taskSelected"
				[preparingFormEvent]="prepareRemoveTaskFormTrigger.asObservable()" (submitDataEvent)="removeTask($event)">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #removeAllTasksForm [mode]="REMOVE_ALL_TASKS" [todoId]="todoId"
				[preparingFormEvent]="prepareRemoveAllTasksFormTrigger.asObservable()" (submitIdEvent)="removeAllTasks($event)">
		</app-ff-todo-generic-task-form>
	</div>
	<div *ngIf="boardContent">
		<h2 class="text-muted text-center"
				data-toggle="tooltip" data-placement="bottom" title="Board ID">{{ boardContent.id }}</h2>
		<h2 class="text-center"
				data-toggle="tooltip" data-placement="bottom" title="Board title">{{ boardContent.name }}</h2>
		<div *ngIf="boardContent.description" class="border border-secondary rounded w-75"
				data-toggle="tooltip" data-placement="bottom" title="Board description">{{ boardContent.description }}</div>
		<div class="text-muted" *ngIf="boardContent.name && !boardContent.description">No description added</div>
		<div *ngIf="boardContent.author">Author: {{ boardContent.author }}</div>
		<div class="text-muted" *ngIf="boardContent.name && !boardContent.author">Unknown author</div>
		<div *ngIf="boardContent.name">
			<button type="button" class="btn btn-primary btn-sm text-end" (click)="prepareEditBoardForm()"
					data-toggle="tooltip" data-placement="bottom" title="Edit Board">
				<i class="fas fa-pencil-alt"></i>&nbsp;Board
			</button>
			<button type="button" class="btn btn-danger btn-sm text-end" (click)="prepareRemoveBoardForm()"
					data-toggle="tooltip" data-placement="bottom" title="Remove Board">
				<i class="fas fa-trash-alt"></i>&nbsp;Board
			</button>
		</div>
	</div>
	<table class="table mt-3" *ngIf="this.boardSelected">
		<tbody>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let phase of phase_labels">
					<h2 class="mt-1 mb-3">{{phase}}</h2>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary" *ngIf="todoCount">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<button type="button" class="btn btn-secondary" (click)="prepareSortTodoForm(idx)">
						<i class="fas fa-sort-amount-up-alt"></i>&nbsp;Todos
					</button>
					<button type="button" class="btn btn-secondary" (click)="prepareSortTaskForm(idx)">
						<i class="fas fa-sort-amount-up-alt"></i>&nbsp;Tasks
					</button>

					<app-ff-todo-sorting-form [todo_list_count]="todo_phase.length" [phase_label]="phase_labels[idx]"
							[todosortfield]="todo_sorting_field[idx]" [todosortdir]="todo_sorting_direction[idx]"
							(todosortfieldChange)="updateTodoSortingField(idx, $event)"
							(todosortdirChange)="updateTodoSortingDirection(idx, $event)"
							(todosortResetTrigger)="resetTodoSorting(idx)"
							[preparingFormEvent]="prepareSortTodoFormTrigger[idx].asObservable()"></app-ff-todo-sorting-form>
					<app-ff-todo-task-sorting-form [task_list_count]="task_count[idx]" [phase_label]="phase_labels[idx]"
							[tasksortfield]="task_sorting_field[idx]" [tasksortdir]="task_sorting_direction[idx]"
							(tasksortfieldChange)="updateTaskSortingField(idx, $event)"
							(tasksortdirChange)="updateTaskSortingDirection(idx, $event)"
							(tasksortResetTrigger)="resetTaskSorting(idx)"
							[preparingFormEvent]="prepareSortTaskFormTrigger[idx].asObservable()"></app-ff-todo-task-sorting-form>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<app-ff-todo-list-per-phase [content]="todo_phase" [phaseNum]="phaseNum" [phase_idx]="idx"
							[readonlyTodo]="readonlyTodo"
							[readonlyTask]="readonlyTask" [displayDateFormat]="displayDateFormat"
							[todoQuerySuccess]="todoQuerySuccess" [showDescriptionLength]="showDescriptionLength[idx]"
							[showTaskCount]="showTaskCount[idx]" [showDateCreated]="showDateCreated[idx]"
							[todosortexec]="todo_sorting_executed[idx]" [tasksortexec]="task_sorting_executed[idx]"
							[todosortfield]="todo_sorting_field[idx]" [tasksortfield]="task_sorting_field[idx]"
							[todosortdir]="todo_sorting_direction[idx]" [tasksortdir]="task_sorting_direction[idx]"
							(editTodoEvent)="prepareEditTodoForm($event)" (cloneTodoEvent)="prepareCloneTodoForm($event)"
							(removeTodoEvent)="prepareRemoveTodoForm($event)"
							(shiftLeftTodoEvent)="shiftTodo($event, LEFT)" (shiftRightTodoEvent)="shiftTodo($event, RIGHT)"
							(addTaskEvent)="prepareAddTaskForm($event)" (editTaskEvent)="prepareEditTaskForm($event)"
							(checkTaskEvent)="checkTask($event)" (removeTaskEvent)="removeTask($event)"
							(removeAllTasksEvent)="prepareRemoveAllTasksForm($event)">
					</app-ff-todo-list-per-phase>
				</td>
			<tr>
		</tbody>
	</table>
</div>
