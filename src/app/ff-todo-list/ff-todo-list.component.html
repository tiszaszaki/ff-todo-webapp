<div class="container" role="main">
	<div>
		<app-ff-todo-generic-todo-form #addTodoForm [mode]="ADD_TODO" [(shown)]="addTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength" [inputDateFormat]="inputDateFormat"
				[preparingFormEvent]="prepareAddTodoFormTrigger.asObservable()"
				(submitDataEvent)="addTodo($event)" (shownChange)="addTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form #editTodoForm [mode]="EDIT_TODO" [(data)]="todoSelected" [(shown)]="editTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength" [inputDateFormat]="inputDateFormat"
				[preparingFormEvent]="prepareEditTodoFormTrigger.asObservable()"
				(submitDataEvent)="updateTodo($event)" (shownChange)="editTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form #removeTodoForm [mode]="REMOVE_TODO" [(data)]="todoSelected" [(shown)]="removeTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength" [inputDateFormat]="inputDateFormat"
				[preparingFormEvent]="prepareRemoveTodoFormTrigger.asObservable()"
				(submitDataEvent)="removeTodo($event)" (shownChange)="removeTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form #removeAllTodosForm [mode]="REMOVE_ALL_TODOS" [(shown)]="removeAllTodosFormShown"
				[preparingFormEvent]="prepareRemoveAllTodosFormTrigger.asObservable()"
				(submitEvent)="removeAllTodos()" (shownChange)="removeAllTodosFormShown = $event"></app-ff-todo-generic-todo-form>
		<!-- >
		<app-ff-todo-generic-todo-form [phase_labels]="phase_labels" [descriptionMaxLength]="descriptionMaxLength" [inputDateFormat]="inputDateFormat">
		</app-ff-todo-generic-todo-form>
		<-->
	</div>
	<div>
		<app-ff-todo-generic-task-form #addTaskForm [mode]="ADD_TASK" [todoId]="todoId" [(shown)]="addTaskFormShown"
				[preparingFormEvent]="prepareAddTaskFormTrigger.asObservable()"
				(submitDataEvent)="addTask($event)" (shownChange)="addTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #editTaskForm [mode]="EDIT_TASK" [todoId]="todoId" [data]="taskSelected" [(shown)]="editTaskFormShown"
				[preparingFormEvent]="prepareEditTaskFormTrigger.asObservable()"
				(submitDataEvent)="updateTask($event)" (shownChange)="editTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #removeTaskForm [mode]="REMOVE_TASK" [todoId]="todoId" [data]="taskSelected" [(shown)]="removeTaskFormShown"
				[preparingFormEvent]="prepareRemoveTaskFormTrigger.asObservable()"
				(submitDataEvent)="removeTask($event)" (shownChange)="removeTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form #removeAllTasksForm [mode]="REMOVE_ALL_TASKS" [todoId]="todoId" [(shown)]="removeAllTasksFormShown"
				[preparingFormEvent]="prepareRemoveAllTasksFormTrigger.asObservable()"
				(submitIdEvent)="removeAllTasks($event)" (shownChange)="removeAllTasksFormShown = $event">
		</app-ff-todo-generic-task-form>
		<!-- >
		<app-ff-todo-generic-task-form [todoId]="todoId"></app-ff-todo-generic-task-form>
		<-->
	</div>
	<app-ff-todo-searching-form [todo_list_count]="todo_count"
			[todosearchterm]="todo_searching_term" [todosearchfield]="todo_searching_field"
			(todosearchcaseChange)="updateTodoSearchingCaseSense($event)" (todosearchtermChange)="updateTodoSearchingTerm($event)"
			(todosearchfieldChange)="updateTodoSearchingField($event)" (updateSubmitStateEvent)="updateSearchSubmit($event)">
	</app-ff-todo-searching-form>
	<table class="table mt-3">
		<tbody>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let phase of phase_labels">
					<h2 class="mt-1 mb-3">{{phase}}</h2>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary" *ngIf="todo_count">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<app-ff-todo-sorting-form [todo_list_count]="todo_phase.length"
							[todosortfield]="todo_sorting_field[idx]" [todosortdir]="todo_sorting_direction[idx]"
							(todosortfieldChange)="updateTodoSortingField(idx, $event)"
							(todosortdirChange)="updateTodoSortingDirection(idx, $event)"
							(todosortResetTrigger)="resetTodoSorting(idx)"></app-ff-todo-sorting-form>

					<app-ff-todo-task-sorting-form [task_list_count]="task_count[idx]"
							[tasksortfield]="task_sorting_field[idx]" [tasksortdir]="task_sorting_direction[idx]"
							(tasksortfieldChange)="updateTaskSortingField(idx, $event)"
							(tasksortdirChange)="updateTaskSortingDirection(idx, $event)"
							(tasksortResetTrigger)="resetTaskSorting(idx)"></app-ff-todo-task-sorting-form>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<app-ff-todo-list-per-phase [content]="todo_phase" [phaseNum]="phaseNum" [readonlyTodo]="readonlyTodo"
							[readonlyTask]="readonlyTask" [displayDateFormat]="displayDateFormat"
							[todoQuerySuccess]="todoQuerySuccess" [showDescriptionLength]="showDescriptionLength[idx]"
							[showDateCreated]="showDateCreated[idx]" [showTaskCount]="showTaskCount[idx]"
							[todosortexec]="todo_sorting_executed[idx]" [tasksortexec]="task_sorting_executed[idx]"
							[todosortfield]="todo_sorting_field[idx]" [tasksortfield]="task_sorting_field[idx]"
							[todosortdir]="todo_sorting_direction[idx]" [tasksortdir]="task_sorting_direction[idx]"
							[todosearchexec]="searchSubmitted" [todosearchcase]="todo_searching_casesense"
							[todosearchterm]="todo_searching_term" [todosearchfield]="todo_searching_field"
							(editTodoEvent)="prepareEditTodoForm($event)" (removeTodoEvent)="prepareRemoveTodoForm($event)"
							(shiftLeftTodoEvent)="shiftTodo($event, LEFT)" (shiftRightTodoEvent)="shiftTodo($event, RIGHT)"
							(addTaskEvent)="prepareAddTaskForm($event)" (editTaskEvent)="prepareEditTaskForm($event)"
							(checkTaskEvent)="checkTask($event)" (removeTaskEvent)="removeTask($event)"
							(removeAllTasksEvent)="prepareRemoveAllTasksForm($event)">
					</app-ff-todo-list-per-phase>
				</td>
			<tr>
		</tbody>
	</table>
</div>
