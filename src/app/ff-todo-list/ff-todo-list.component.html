<div class="content" role="main">
	<div class="d-grid gap-2 w-25 my-2" *ngIf="!readonlyTodo">
		<button type="button" class="btn btn-primary" (click)="prepareAddTodoForm()"
				data-toggle="tooltip" data-placement="bottom" title="Add new Todo">
			<i class="fas fa-plus"></i>
		</button>
		<button type="button" class="btn btn-danger btn-sm" (click)="prepareRemovingAllTodos()"
				data-toggle="tooltip" data-placement="bottom" title="Remove all Todos"
				[disabled]="!todo_count">
			<i class="fas fa-broom"></i>
		</button>
		<button type="button" class="btn btn-warning btn-sm" (click)="initTodoList([])"
				data-toggle="tooltip" data-placement="bottom" title="Refresh Todo list">
				<i class="fas fa-sync-alt"></i>
		</button>
		<button type="button" class="btn btn-warning btn-sm" (click)="restoreTodoList()"
				data-toggle="tooltip" data-placement="bottom" title="Restore Todo list">
				<i class="fas fa-trash-restore-alt"></i>
		</button>
	</div>
	<div>
		<app-ff-todo-generic-todo-form [mode]="ADD_TODO" [(shown)]="addTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength"
				(submitDataEvent)="addTodo($event)" (shownChange)="addTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form [mode]="EDIT_TODO" [(data)]="todoSelected" [(shown)]="editTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength"
				(submitDataEvent)="updateTodo($event)" (shownChange)="editTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form [mode]="REMOVE_TODO" [(data)]="todoSelected" [(shown)]="removeTodoFormShown" [phase_labels]="phase_labels"
				[descriptionMaxLength]="descriptionMaxLength"
				(submitDataEvent)="removeTodo($event)" (shownChange)="removeTodoFormShown = $event">
		</app-ff-todo-generic-todo-form>
		<app-ff-todo-generic-todo-form [mode]="REMOVE_ALL_TODOS" [(shown)]="removeAllTodosFormShown"
				(submitEvent)="removeAllTodos()" (shownChange)="removeAllTodosFormShown = $event"></app-ff-todo-generic-todo-form>
	</div>
	<div>
		<app-ff-todo-generic-task-form [mode]="ADD_TASK" [todoId]="todoId" [(shown)]="addTaskFormShown"
				(submitDataEvent)="addTask($event)" (shownChange)="addTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form [mode]="EDIT_TASK" [todoId]="todoId" [data]="taskSelected" [(shown)]="editTaskFormShown"
				(submitDataEvent)="updateTask($event)" (shownChange)="editTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form [mode]="REMOVE_TASK" [todoId]="todoId" [data]="taskSelected" [(shown)]="removeTaskFormShown"
				(submitDataEvent)="removeTask($event)" (shownChange)="removeTaskFormShown = $event">
		</app-ff-todo-generic-task-form>
		<app-ff-todo-generic-task-form [mode]="REMOVE_ALL_TASKS" [todoId]="todoId" [(shown)]="removeAllTasksFormShown"
				(submitIdEvent)="removeAllTasks($event)" (shownChange)="removeAllTasksFormShown = $event">
		</app-ff-todo-generic-task-form>
	</div>
	<app-ff-todo-searching-form [todo_list_count]="todo_count"
		[todosearchterm]="todo_searching_term" [todosearchfield]="todo_searching_field"
		(todosearchtermChange)="updateTodoSearchingTerm($event)" (todosearchfieldChange)="updateTodoSearchingField($event)"
		(updateSubmitStateEvent)="updateSearchSubmit($event)"></app-ff-todo-searching-form>
	<table class="table mt-3">
		<tbody>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let phase of phase_labels">
					<h2 class="mt-1 mb-3">{{phase}}</h2>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary" *ngIf="todo_count">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<app-ff-todo-sorting-form [todo_list_count]="todo_phase.length"
							(todosortfieldChange)="updateTodoSortingField(idx, $event)"
							(todosortdirChange)="updateTodoSortingDirection(idx, $event)"></app-ff-todo-sorting-form>

					<app-ff-todo-task-sorting-form [task_list_count]="task_count[idx]"
							(tasksortfieldChange)="updateTaskSortingField(idx, $event)"
							(tasksortdirChange)="updateTaskSortingDirection(idx, $event)"></app-ff-todo-task-sorting-form>
				</td>
			</tr>
			<tr class="row border border-2 border-secondary">
				<td class="col border border-secondary" *ngFor="let todo_phase of todo_list; let idx=index">
					<app-ff-todo-list-per-phase [content]="todo_phase" [phaseNum]="phaseNum"
							[readonlyTodo]="readonlyTodo" [readonlyTask]="readonlyTask" [customDateFormat]="customDateFormat"
							[todosortfield]="todo_sorting_field[idx]" [todosortdir]="todo_sorting_direction[idx]"
							[tasksortfield]="task_sorting_field[idx]" [tasksortdir]="task_sorting_direction[idx]"
							(editTodoEvent)="prepareEditTodoForm($event)" (removeTodoEvent)="prepareRemoveTodoForm($event)"
							(shiftLeftTodoEvent)="shiftTodo($event, LEFT)" (shiftRightTodoEvent)="shiftTodo($event, RIGHT)"
							(addTaskEvent)="prepareAddTaskForm($event)" (editTaskEvent)="prepareEditTaskForm($event)"
							(checkTaskEvent)="checkTask($event)" (removeTaskEvent)="removeTask($event)"
							(removeAllTasksEvent)="prepareRemoveAllTasksForm($event)">
					</app-ff-todo-list-per-phase>
				</td>
			<tr>
		</tbody>
	</table>
</div>
